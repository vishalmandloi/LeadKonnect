
<div class="clearfix"></div>

<div class="">
    <div class="container" ng-init="vm.init()">
        <div class="row">
            <div class="col-sm-12">
                <div class="dmp-container jobs">
                    <ul class="nav nav-tabs">
                        <li ng-class="{'active':vm.active==0}" ng-click="vm.ActiveTab(0)"><a><i class="icon-medical109"></i> Available Jobs</a></li>
                        <li ng-class="{'active':vm.active==1}" ng-click="vm.ActiveTab(1)"><a><i class="icon-loading11"></i> Jobs Awaiting Approval</a></li>
                        <li ng-class="{'active':vm.active==2}" ng-click="vm.ActiveTab(2)"><a><i class="icon-verification25"></i> Approved Jobs</a></li>
                        <li ng-class="{'active':vm.active==4}" ng-click="vm.ActiveTab(4)"><a><i class="icon-done"></i> Completed Jobs</a></li>
                    </ul>
                    <div class="tab-content">
                        <div>
                            <select ng-show="vm.isMultiLocation" id="jobs-table-sort" ng-model="vm.jobReqModel.locationTyp" ng-change="vm.SearchJob()" required>
                                <option value=""> Primary</option>
                                <option value="1">Secondary</option>
                            </select>
                            <select ng-model="vm.selectedMonth" id="finance-table-month"
                                    ng-options="month as month.value for month in vm.months"></select>

                            <select ng-model="vm.selectedYear" id="finance-table-year"
                                    ng-options="year as year.value for year in vm.years"></select>
                            <button type="button" id="profile-submit-btn" class="ho-submit-btn" ng-click="vm.SearchJob()">Search</button>

                            <!--<select id="jobs-table-sort">
                                <option>Sort By</option>
                                <option>Distance</option>
                                <option>Rate of pay</option>
                            </select>
                            <input id="datepick1" type="text" readonly="readonly"class="text-boxsize" ng-change="vm.GetLocumJobByStatus()"
                                   ng-click="openFromDatePicker($event)"
                                   datepicker-popup="{{format}}"
                                   ng-model="vm.jobReqModel.date"
                                   is-open="fromDateopened"
                                   datepicker-options="dateOptions"
                                   date-disabled="disabled(date, mode)"
                                   close-text="Close"
                                   placeholder="Select Date" required />
                            <!--table Start here-->
                            <div id="">
                                <div class="alert alert-info" ng-show="vm.jobList.length==0">No records found!</div>
                                <div ng-scrollbars ng-scrollbars-config="config" ng-scrollbars-update=updateScrollbar class="table-responsive default-skin demo content">
                                    <table class="table table-bordered table-hover jobs-table">
                                        <thead>
                                            <tr>
                                                <th>Date</th>
                                                <th>Day</th>
                                                <th>Time</th>
                                                <th>Job ID</th>
                                                <th>Pharmacy</th>
                                                <!--    <th>Contact Person</th> -->
                                                <th>Rate</th>
                                                <th>Total</th>
                                                <!-- <th>Travel Expense</th> -->
                                                <th>Distance</th>
                                                <!--<th>Response Time</th>-->
                                                <th></th>
                                                <th>Status</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr ng-repeat="d in vm.jobList | filter :{jobStatus:vm.active} track by $index" ng-class="{'emergencyShift':vm.active==0 && d.emergencyShift=='1'}">
                                                <td>{{vm.ConvertDate(d.dateFrom)| date:'dd-MMM-yy'}}</td>
                                                <td>{{vm.ConvertDate(d.dateFrom) | date:'EEE'}}</td>
                                                <td>{{d.timeFrom+'-'+d.timeTo}}</td>
                                                <td>{{d.jobUniqueId}}</td>
                                                <td>
                                                    <span ui-sref="user.pharmacyProfile({id:d.creatorId})"><a href="#">{{d.pharmacyName}}</a></span>
                                                </td>
                                                <!--<td>{{d.creatorName}}</td> -->
                                                <td>
                                                    £ {{d.costPerHour}}/hr
                                                </td>

                                                <td>£ {{d.totalCost}}</td>
                                                <!--<td>{{d.travelExpensePerMile}}</td> -->
                                                <td>
                                                    {{d.jobDistance}} miles
                                                </td>

                                                <!--<td>4 hrs.</td>-->
                                                <td>
                                                    <i class="icon-message" data-target="#jobs-message-modal" data-toggle="modal" ng-click="vm.openMessageBox(d)" style="font-size:24px; color:#008fd6"></i>
                                                    <!-- <button class="jobs-msg-btn" data-target="#jobs-message-modal" data-toggle="modal" ng-click="vm.openMessageBox(d)">Message</button> -->
                                                </td>
                                                <td>
                                                    <button ng-show="d.jobStatus=='0'" class="apply-btn" ng-click="vm.AppliedJob(d)">Apply Now</button>
                                                    <button ng-show="d.jobStatus=='1'" class="approval-btn">Awaiting Approval</button>
                                                    <button ng-show="d.jobStatus=='2'" class="approved-btn">Approved job</button>
                                                    <button ng-show="d.jobStatus=='3'" class="booked-btn">Completed Job</button>
                                                    <button ng-show="d.jobStatus=='5'" class="booked-btn">Reject</button>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- Modal -->
<div class="modal fade" id="jobs-message-modal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title" id="myModalLabel">Message</h4>
            </div>
            {{msg}}
            <div class="modal-body">
                <div ng-scrollbars ng-scrollbars-config="config" ng-scrollbars-update=updateScrollbar class="table-responsive default-skin demo content">
                    <div class="mm-msg-section" ng-repeat="msg in vm.messageResult track by $index" ng-class="msg.userType=='2'? 'rightChat' : 'leftChat'" id="{{$last ? 'last' : ''}}">
                        <h5>{{msg.userType='2'? msg.locumName:'msg.pharmacyName' }}</h5>
                        <p>{{msg.message}}</p>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <div class="mf-textbox">
                    <input type="text" class="form-control" ng-model="message" placeholder="Write a Message here" ng-enter="vm.sendMessage(message); message=''">
                </div>
            </div>
        </div>
    </div>
</div>


<!-- Moblie Verification -->
<a data-target="#mobile-varification" data-toggle="modal" id="lnkMobileVerify" style="display:none"> moblie verify </a>
<div class="modal fade" id="mobile-varification" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title" id="myModalLabel">Mobile no. verification</h4>
            </div>
            <div class="modal-body">
                <form class="ng-pristine ng-valid ng-valid-required">
                     <div class="form-group">
                        <label for="recipient-name" class="control-label">Mobile Number :</label>
                        <input type="text"  ng-model="vm.ReqMobileVerify.mobileNumber" readonly="" class="form-control">
                    </div>
                    <div class="form-group">
                        <label for="recipient-name" class="control-label">Update Mobile Number (if above no. is incorrect):</label>
                        <input type="text" ng-model="vm.ReqMobileVerify.newMobileNumber"  class="form-control" placeholder="Update Mobile Number (if above no. is incorrect):" >
                    </div>
                    <div class="modal-footer">
                        <button data-target="#otp-varification" data-toggle="modal" id="hr-login-btn" data-dismiss="modal">Got a verification code ?</button>
                        <button type="submit" id="hr-login-btn" data-ng-click="vm.SendOTP()" >Send Verification</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>


<!-- OTP Verification -->
<a data-target="#otp-varification" data-dismiss="modal"  data-toggle="modal" id="lnkOTPVerify" style="display:none"> otp verify </a>
<div class="modal fade" id="otp-varification" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title" id="myModalLabel">Mobile Verification</h4>
            </div>
            <div class="modal-body">
                <form class="ng-pristine ng-valid ng-valid-required">
                    <div class="form-group">
                        <label for="recipient-name" class="control-label">Verification Code :</label>
                        <input type="password" ng-model="vm.otpNumber" required class="form-control" >
                    </div>
                    <div class="modal-footer">
                        <a id="hr-login-btn" data-ng-click="vm.ReSendOtpFunc()">Resend Code</a>
                        <button type="submit" id="hr-login-btn" data-ng-click="vm.VerifiedOtp()">Verify</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>